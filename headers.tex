%%% Packages
\usepackage{boxedminipage} 
\usepackage{xspace} 
\usepackage{wrapfig}
\usepackage{mleftright} 
\usepackage{xcolor} 
\usepackage{soul} 
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsmath} 
\usepackage{enumitem}
\usepackage{bbm}
\usepackage{geometry}
\usepackage{framed}

\let\leq\leqslant
\let\geq\geqslant





%%% Crypto Package
\usepackage[lambda,advantage,operators,sets,adversary,landau,probability,notions,logic,ff,mm,primitives,events,complexity,asymptotics,keys]{cryptocode}
\renewcommand{\expectationname}{\ensuremath{E}}


%%% Tikz Packages
\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{fit}
\usetikzlibrary{calc}
\usetikzlibrary{backgrounds}
\usetikzlibrary{shapes}
\usetikzlibrary{patterns}
\usetikzlibrary{matrix}
\usetikzlibrary{intersections}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{shapes.arrows}
\usetikzlibrary{arrows,automata}
\usetikzlibrary{quotes}
\usetikzlibrary{decorations.pathreplacing}


%%% No figures taking up one whole page
\renewcommand{\floatpagefraction}{.8}


%%% Document Design Choices
\geometry{left=1in, right=1in, top=1in, bottom=1in}




%%% Theorem, etc.
\makeatletter
\newtheorem*{rep@theorem}{\rep@title}
\newcommand{\newreptheorem}[2]{%
\newenvironment{rep#1}[1]{%
 \def\rep@title{\theoremref{##1} Restated}%
 \begin{rep@theorem}}%
 {\end{rep@theorem}}}
\makeatother

\makeatletter
\newtheorem*{rep@lemma}{\rep@title}
\newcommand{\newreplemma}[2] {%
\newenvironment{rep#1}[1]{%
 \def\rep@title{\lemmaref{##1} Restated}%
 \begin{rep@lemma}}%
 {\end{rep@lemma}}}
\makeatother

\newtheorem{theorem}{Theorem}
\newreptheorem{theorem}{Theorem}
\newtheorem{importedlemma}{Imported Lemma}
\newtheorem{importedtheorem}{Imported Theorem} 
\newtheorem{informaltheorem}{Informal Theorem}
\newtheorem{definition}{Definition}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newreplemma{lemma}{Lemma}
\newtheorem{claim}{Claim}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{informalcorollary}[theorem]{Informal Corollary}
\newtheorem{observation}{Observation}
\newtheorem{property}{Property}


%%% Boxed Algorithm Enviroment
\newenvironment{boxedalgo}
  {\begin{center}\begin{boxedminipage}{\linewidth}}
  {\end{boxedminipage}\end{center}}


%%% References
\newcommand{\namedref}[2]{\hyperref[#2]{#1~\ref*{#2}}\xspace}
\newcommand{\lemmaref}[1]{\namedref{Lemma}{lem:#1}}
\newcommand{\propref}[1]{\namedref{Proposition}{prop:#1}}
\newcommand{\theoremref}[1]{\namedref{Theorem}{thm:#1}}
\newcommand{\claimref}[1]{\namedref{Claim}{clm:#1}}
\newcommand{\corolref}[1]{\namedref{Corollary}{corol:#1}}
\newcommand{\figureref}[1]{\namedref{Figure}{fig:#1}}
\newcommand{\tableref}[1]{\namedref{Table}{tbl:#1}}
\newcommand{\equationref}[1]{\namedref{Equation}{eq:#1}}
\newcommand{\defref}[1]{\namedref{Definition}{def:#1}}
\newcommand{\observationref}[1]{\namedref{Observation}{obs:#1}}
\newcommand{\procedureref}[1]{\namedref{Procedure}{proc:#1}}
\newcommand{\importedtheoremref}[1]{\namedref{Imported Theorem}{impthm:#1}}
\newcommand{\informaltheoremref}[1]{\namedref{Informal Theorem}{infthm:#1}}
\newcommand{\importedlemmaref}[1]{\namedref{Imported Lemma}{implem:#1}}

\newcommand{\sectionref}[1]{\namedref{Section}{sec:#1}}
\newcommand{\subsectionref}[1]{\namedref{Subsection}{subsec:#1}}
\newcommand{\appendixref}[1]{\namedref{Appendix}{app:#1}}
\newcommand{\propertyref}[1]{\namedref{Property}{prop:#1}}


%%% English
\newcommand{\ie}{\text{i.e.}\xspace}
\renewcommand{\st}{\text{s.t.}\xspace}
\newcommand{\etal}{\text{et al.}\xspace}
\newcommand{\naive}{\text{na\"ive}\xspace}
\newcommand{\wrt}{\text{w.r.t.}\xspace}
\newcommand{\whp}{\text{w.h.p.}\xspace}
\newcommand{\resp}{\text{resp.}\xspace}
\newcommand{\eg}{\text{e.g.}\xspace}
\newcommand{\cf}{\text{cf.}\xspace}
\newcommand{\visavis}{\text{vis-\`a-vis}\xspace}
\newcommand{\aka}{\text{a.k.a.}\xspace}
\newcommand{\ala}{\text{\`{a} la}\xspace}


%%% Names
\newcommand{\gacs}[0]{G\'acs\xspace}
\newcommand{\korner}[0]{K\"orner\xspace}
\newcommand{\turan}[0]{Tur{\'a}n\xspace}
\newcommand{\erdos}[0]{Erd\H{o}s\xspace}


%% Cal Alphabets
\newcommand{\cA}{\ensuremath{{\mathcal A}}\xspace}
\newcommand{\cB}{\ensuremath{{\mathcal B}}\xspace}
\newcommand{\cC}{\ensuremath{{\mathcal C}}\xspace}
\newcommand{\cD}{\ensuremath{{\mathcal D}}\xspace}
\newcommand{\cE}{\ensuremath{{\mathcal E}}\xspace}
\newcommand{\cF}{\ensuremath{{\mathcal F}}\xspace}
\newcommand{\cG}{\ensuremath{{\mathcal G}}\xspace}
\newcommand{\cH}{\ensuremath{{\mathcal H}}\xspace}
\newcommand{\cI}{\ensuremath{{\mathcal I}}\xspace}
\newcommand{\cJ}{\ensuremath{{\mathcal J}}\xspace}
\newcommand{\cK}{\ensuremath{{\mathcal K}}\xspace}
\newcommand{\cL}{\ensuremath{{\mathcal L}}\xspace}
\newcommand{\cM}{\ensuremath{{\mathcal M}}\xspace}
\newcommand{\cN}{\ensuremath{{\mathcal N}}\xspace}
\newcommand{\cO}{\ensuremath{{\mathcal O}}\xspace}
\newcommand{\cP}{\ensuremath{{\mathcal P}}\xspace}
\newcommand{\cQ}{\ensuremath{{\mathcal Q}}\xspace}
\newcommand{\cR}{\ensuremath{{\mathcal R}}\xspace}
\newcommand{\cS}{\ensuremath{{\mathcal S}}\xspace}
\newcommand{\cT}{\ensuremath{{\mathcal T}}\xspace}
\newcommand{\cU}{\ensuremath{{\mathcal U}}\xspace}
\newcommand{\cV}{\ensuremath{{\mathcal V}}\xspace}
\newcommand{\cW}{\ensuremath{{\mathcal W}}\xspace}
\newcommand{\cX}{\ensuremath{{\mathcal X}}\xspace}
\newcommand{\cY}{\ensuremath{{\mathcal Y}}\xspace}
\newcommand{\cZ}{\ensuremath{{\mathcal Z}}\xspace}


%% Bold Alphabets
\newcommand{\bA}{\ensuremath{{\mathbf A}}\xspace}
\newcommand{\bB}{\ensuremath{{\mathbf B}}\xspace}
\newcommand{\bC}{\ensuremath{{\mathbf C}}\xspace}
\newcommand{\bD}{\ensuremath{{\mathbf D}}\xspace}
\newcommand{\bE}{\ensuremath{{\mathbf E}}\xspace}
\newcommand{\bF}{\ensuremath{{\mathbf F}}\xspace}
\newcommand{\bG}{\ensuremath{{\mathbf G}}\xspace}
\newcommand{\bH}{\ensuremath{{\mathbf H}}\xspace}
\newcommand{\bI}{\ensuremath{{\mathbf I}}\xspace}
\newcommand{\bJ}{\ensuremath{{\mathbf J}}\xspace}
\newcommand{\bK}{\ensuremath{{\mathbf K}}\xspace}
\newcommand{\bL}{\ensuremath{{\mathbf L}}\xspace}
\newcommand{\bM}{\ensuremath{{\mathbf M}}\xspace}
\newcommand{\bN}{\ensuremath{{\mathbf N}}\xspace}
\newcommand{\bO}{\ensuremath{{\mathbf O}}\xspace}
\newcommand{\bP}{\ensuremath{{\mathbf P}}\xspace}
\newcommand{\bQ}{\ensuremath{{\mathbf Q}}\xspace}
\newcommand{\bR}{\ensuremath{{\mathbf R}}\xspace}
\newcommand{\bS}{\ensuremath{{\mathbf S}}\xspace}
\newcommand{\bT}{\ensuremath{{\mathbf T}}\xspace}
\newcommand{\bU}{\ensuremath{{\mathbf U}}\xspace}
\newcommand{\bV}{\ensuremath{{\mathbf V}}\xspace}
\newcommand{\bW}{\ensuremath{{\mathbf W}}\xspace}
\newcommand{\bX}{\ensuremath{{\mathbf X}}\xspace}
\newcommand{\bY}{\ensuremath{{\mathbf Y}}\xspace}
\newcommand{\bZ}{\ensuremath{{\mathbf Z}}\xspace}


%% Black-board Bold Alphabets
\newcommand{\bbA}{\ensuremath{{\mathbb A}}\xspace}
\newcommand{\bbB}{\ensuremath{{\mathbb B}}\xspace}
\newcommand{\bbC}{\ensuremath{{\mathbb C}}\xspace}
\newcommand{\bbD}{\ensuremath{{\mathbb D}}\xspace}
\newcommand{\bbE}{\ensuremath{{\mathbb E}}\xspace}
\newcommand{\bbF}{\ensuremath{{\mathbb F}}\xspace}
\newcommand{\bbG}{\ensuremath{{\mathbb G}}\xspace}
\newcommand{\bbH}{\ensuremath{{\mathbb H}}\xspace}
\newcommand{\bbI}{\ensuremath{{\mathbb I}}\xspace}
\newcommand{\bbJ}{\ensuremath{{\mathbb J}}\xspace}
\newcommand{\bbK}{\ensuremath{{\mathbb K}}\xspace}
\newcommand{\bbL}{\ensuremath{{\mathbb L}}\xspace}
\newcommand{\bbM}{\ensuremath{{\mathbb M}}\xspace}
\newcommand{\bbN}{\ensuremath{{\mathbb N}}\xspace}
\newcommand{\bbO}{\ensuremath{{\mathbb O}}\xspace}
\newcommand{\bbP}{\ensuremath{{\mathbb P}}\xspace}
\newcommand{\bbQ}{\ensuremath{{\mathbb Q}}\xspace}
\newcommand{\bbR}{\ensuremath{{\mathbb R}}\xspace}
\newcommand{\bbS}{\ensuremath{{\mathbb S}}\xspace}
\newcommand{\bbT}{\ensuremath{{\mathbb T}}\xspace}
\newcommand{\bbU}{\ensuremath{{\mathbb U}}\xspace}
\newcommand{\bbV}{\ensuremath{{\mathbb V}}\xspace}
\newcommand{\bbW}{\ensuremath{{\mathbb W}}\xspace}
\newcommand{\bbX}{\ensuremath{{\mathbb X}}\xspace}
\newcommand{\bbY}{\ensuremath{{\mathbb Y}}\xspace}
\newcommand{\bbZ}{\ensuremath{{\mathbb Z}}\xspace}


%%% Common commands
\newcommand{\pred}[1]{\ensuremath{\mathsf{#1}}\xspace}
\newcommand{\SD}[2]{\ensuremath{\pred{SD}\left({#1},{#2}\right)}\xspace}
\renewcommand{\enc}[1]{\mathsf{Enc}\left({#1}\right)}
\newcommand{\Enc}{\mathsf{Enc}}
\renewcommand{\dec}[1]{\mathsf{Dec}\left({#1}\right)}
\newcommand{\Dec}{\mathsf{Dec}}
\newcommand{\keygen}{\mathsf{KeyGen}}
\newcommand{\setup}{\mathsf{Setup}}
\newcommand{\msk}{\mathsf{msk}}
\newcommand{\mpk}{\mathsf{mpk}}
\newcommand{\id}{\mathsf{id}}
\newcommand{\msg}{\mathsf{msg}}
\newcommand{\Ext}{\mathsf{Ext}}
\newcommand{\zo}{\ensuremath{{\{0,1\}}}\xspace}
\newcommand{\defeq}[0]{\ensuremath{{\;\vcentcolon=\;}}\xspace}
\newcommand{\drawn}{\ensuremath{\xleftarrow{\$}}\xspace}
\newcommand{\wt}{\ensuremath{\mathsf{wt}}\xspace}
\newcommand{\hd}{\ensuremath{\mathsf{HD}}\xspace}
\newcommand{\draw}{\leftarrow}
\newcommand{\eps}{\epsilon}
\newcommand{\gf}[1]{\mathbb{G}\mathbb{F}\left({#1}\right)}


%%% Circuits
\renewcommand{\AC}[1]{\ensuremath{\mathsf{AC}^{#1}}\xspace}
\renewcommand{\NC}[1]{\ensuremath{\mathsf{NC}^{#1}}\xspace}


%%%  Argmin and argmax with subscripts in display mode
\def\argmin{\mathop{\mathrm{argmin}}\limits}
\def\argmax{\mathop{\mathrm{argmax}}\limits}


%%% Multiline subscript command \mathstack
\NewDocumentCommand\mathstack{>{\SplitList{;}}m}
  {\ensuremath{
    \begin{smallmatrix}
      \ProcessList{#1}{ \insertone }    
    \end{smallmatrix}
  }}
\newcommand{\insertone}[1]{\ensuremath{#1}\\}


\def\proba{\mathop{\mathrm{Pr}}\limits}
\renewcommand{\probsub}[2]{\proba_{#1}\left[{#2}\right]}

\def\expt{\mathop{\mathrm{E}}\limits}
\renewcommand{\expsub}[2]{\expt_{#1}\left[{#2}\right]}

%%% Local terms

\renewcommand{\max}{\mathsf{max}}
\let\epsilon\varepsilon